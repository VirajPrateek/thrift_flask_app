{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}{{ tableFor }}{% endblock %}</h1>
{% endblock %}

{% block content %}

<div class="result" style="overflow-x: auto; overflow-y: auto;">
  {% if tableFor == 'Balance Enquiry' %}
    Available balance: Rs. <span class="balance">{{bal}}</span>/-

 {% elif tableFor == 'Current Requests' or tableFor == '' %}
    {% if (data|length == 0) %}
        No requests today!<br/>
        Go to side bar to 'Request Item' :)

    {% else %}
        {% for item in data %}
        <form method='post' id ='{{ item[0] }}' action="{{ url_for('features.manage_request') }}">
        <div>
           <span style="font-size:20px;">{{item[1]}}</span><br/>
           <span style="font-size: 12px;"></span>{{item[2]}}</span><br/><br/>
           <span style="font-size:10px; color:white;">{{item[3]}}|{{item[4]}}</span>
        <input type = 'hidden' name ='item_id' id = 'item_id' value='{{item[0]}}'>
        <input type = 'submit' value = 'Done' name = 'manage-request-btn'>
<!--onclick="document.getElementById('{{item[0]}}').style.display='none';"-->
        </div>
        </form>
        {% endfor %}
    {% endif %}

 {% else %}
  <table>

    {% if tableFor == 'Incomes' %}
     *Recent 30 transactions
    <thead>
      <th>ID</th>
      <th>Added On</th>
      <th>Source</th>
      <th>Amount</th>
      <th>Received by</th>
      <th>Inserted by</th>
      <th>Remarks</th>
    </thead>
  {% endif %}
  {% if tableFor == 'Expenditures' %}
    *Recent 30 transactions
    <thead>
      <th>ID</th>
      <th>Date</th>
      <th>Category</th>
      <th>Items</th>
      <th>Amount</th>
      <th>Spent by</th>
      <th>Inserted by</th>
    </thead>
    {% endif %}

  {% if tableFor == 'Users List' %}
    <thead>
      <th>ID</th>
      <th>Username</th>
    </thead>
  {% endif %}

 {% if tableFor == 'Insights' %}
    <thead>
      <caption>Who receives the money?(Income)</caption>
      <th>Received By</th>
      <th>Times Received</th>
      <th>Total Amount Received</th>
    </thead>
     {% for item in data2 %}
  <tr>
      {% for i in range(item|length) %}
        <td>{{item[i]}}</td>
      {% endfor %}
  </tr>
  {% endfor %}
  </table>
<div id="pie-who-receives-the-money"></div>
  <br/><br/>
<script type="text/javascript">
// Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart and set the chart values
function drawChart() {
  var data = google.visualization.arrayToDataTable([
      ['Category', 'Amount Spent'],
    {%  for i in range(data2|length) %}
            ['{{ data2[i][0] }}', {{ data2[i][2] }} ],
    {% endfor %}
]);

  // Optional; add a title and set the width and height of the chart
  var options = {'title':'Who receives the money?(amount)', 'width':360, 'height':240,
  backgroundColor: 'transparent', is3D: true};

  // Display the chart inside the <div> element with id="piechart"
  var chart = new google.visualization.PieChart(document.getElementById('pie-who-receives-the-money'));
  chart.draw(data, options);
}
</script>

  <table>
  <thead>
      <caption>Where is money spent?</caption>
      <th>Category</th>
      <th>Times Spent</th>
      <th>Total Amount Spent</th>
    </thead>
     {% for item in data3 %}
  <tr>
      {% for i in range(item|length) %}
        <td>{{item[i]}}</td>
      {% endfor %}
  </tr>
  {% endfor %}
  </table>
<div id="pie-where-is-money-spent"></div>
  <br/><br/>
<script type="text/javascript">
// Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart and set the chart values
function drawChart() {
  var data = google.visualization.arrayToDataTable([
      ['Category', 'Amount Spent'],
    {%  for i in range(data3|length) %}
            ['{{ data3[i][0] }}', {{ data3[i][2] }} ],
    {% endfor %}
]);

  // Optional; add a title and set the width and height of the chart
  var options = {'title':'Where is money spent?(amount)', 'width':360, 'height':240,
  backgroundColor: 'transparent', is3D: true};

  // Display the chart inside the <div> element with id="piechart"
  var chart = new google.visualization.PieChart(document.getElementById('pie-where-is-money-spent'));
  chart.draw(data, options);
}
</script>
  <table>
    <thead>
      <caption>Who spends the most?</caption>
      <tr>
      <th>Spent By</th>
      <th>Times Spent</th>
      <th>Total Amount Spent</th>
      </tr>
    </thead><tbody>
  {% endif %}

    {% for item in data %}
  <tr>
      {% for i in range(item|length) %}
        <td>{{item[i]}}</td>
      {% endfor %}
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endif%}
</div>


{% endblock %}



















